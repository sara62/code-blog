<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/default.min.css">
    <link rel="stylesheet" type="text/css" href="styles/secretStyles.css">
    <title>Add Stuff</title>
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="highlight.pack.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>


  </head>
  <body>
    <section>
      <header>
        <h1>Add an Article</h1>
      </header>
    </section>


    <section>
      <main>
        <form id="editForm">
          <div>
            <span>Title: </span><input type="text" name="title" id="title" required>
          </div>

          <div>
            <span>Category: </span><input type="text" name="category" id="category" required>
          </div>

          <div>
            <span>Author: </span><input type="text" name="author" id="author" required>
          </div>

          <div>
            <span>AuthorUrl: </span><input type="text" name="authorUrl" id="authorUrl" required>
          </div>

          <div>
            <div>
              <span>Content: </span>
            </div>

            <div>
                <textarea id="content" rows="4" columns="30" name="content" required></textarea>
            </div>
          </div>
          <div><input type="submit" id="submit" value="Submit"></div>
        </form>
        <div id="preview"></div>
        <div id="json"></div>
        <script>
        $('#preview').html(hljs.highlightAuto('<pre class="javascript"><code id="ids" class="javascript" >function(){};</code></pre>').value);
          var renderPreview = function() {
            var title = marked($('#title').val());
            var titleLength = title.length;
            title = title.substr(3, (titleLength - 8));
            var category = marked($('#category').val());
            var categoryLength = category.length;
            category = category.substr(3, (categoryLength - 8));
            var author = marked($('#author').val());
            var authorLength = author.length;
            author = author.substr(3, (authorLength - 8));
            var authorUrl = marked($('#authorUrl').val());
            var authorUrlLength = authorUrl.length;
            authorUrl = authorUrl.substr(3, (authorUrlLength - 8))
            var content = marked($('#content').val());
            var contentLength = content.length;
            content = content.substr(3, (contentLength - 8))
            var date = new Date();
            date = date.getFullYear() + '-' + date.getMonth() + '-' + date.getDate();
            var preview = '<article id="article-basic-template"><div class="article-title"><h2>'+ title +
            '</h2></div><div class="article-meta-information"><div class="article-author"><span>Author: </span><a href="'+ authorUrl+'" target="_blank" rel="author">'+author+'</a></div>'+
            '<div class="article-category"><span>'+category+'</span></div>'+
            '<div class="article-published-date"><span>Published on </span><span>'+date+'</span></div></div>'+
            '<div class="article-content">'+ content +'</div></article>';

            $('#preview').html(preview);
            var json = '{title: \''+ title + '\', category: \''+ category + '\', author: \''+ author+ '\', authorUrl: \''+ authorUrl +'\', publishedOn: \'' + date + '\', body: \'' + content + '\'},';
            $('#json').text(json);
          }

          $('#editForm').submit(function(event){
            event.preventDefault();
            renderPreview();
          });


        </script>
      </main>

    </section>

    <section>
      <footer></footer>
    </section>
  </body>
</html>
